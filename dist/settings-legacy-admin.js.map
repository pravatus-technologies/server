{"version":3,"file":"settings-legacy-admin.js?v=3c0b6c626d82144cadab","mappings":";;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;AEtJA;AACA;AACA;AACA;AACA","sources":["webpack:///nextcloud/apps/settings/src/admin.js","webpack:///nextcloud/webpack/before-startup","webpack:///nextcloud/webpack/startup","webpack:///nextcloud/webpack/after-startup"],"sourcesContent":["/**\n * SPDX-FileCopyrightText: 2022 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nwindow.addEventListener('DOMContentLoaded', () => {\n  $('#loglevel').change(function () {\n    $.post(OC.generateUrl('/settings/admin/log/level'), {\n      level: $(this).val()\n    }, () => {\n      OC.Log.reload();\n    });\n  });\n  $('#mail_smtpauth').change(function () {\n    if (!this.checked) {\n      $('#mail_credentials').addClass('hidden');\n    } else {\n      $('#mail_credentials').removeClass('hidden');\n    }\n  });\n  $('#mail_smtpmode').change(function () {\n    if ($(this).val() !== 'smtp') {\n      $('#setting_smtpauth').addClass('hidden');\n      $('#setting_smtphost').addClass('hidden');\n      $('#mail_smtpsecure_label').addClass('hidden');\n      $('#mail_smtpsecure').addClass('hidden');\n      $('#mail_credentials').addClass('hidden');\n      $('#mail_sendmailmode_label, #mail_sendmailmode').removeClass('hidden');\n    } else {\n      $('#setting_smtpauth').removeClass('hidden');\n      $('#setting_smtphost').removeClass('hidden');\n      $('#mail_smtpsecure_label').removeClass('hidden');\n      $('#mail_smtpsecure').removeClass('hidden');\n      if ($('#mail_smtpauth').is(':checked')) {\n        $('#mail_credentials').removeClass('hidden');\n      }\n      $('#mail_sendmailmode_label, #mail_sendmailmode').addClass('hidden');\n    }\n  });\n  const changeEmailSettings = function () {\n    if (OC.PasswordConfirmation.requiresPasswordConfirmation()) {\n      OC.PasswordConfirmation.requirePasswordConfirmation(changeEmailSettings);\n      return;\n    }\n    OC.msg.startSaving('#mail_settings_msg');\n    $.ajax({\n      url: OC.generateUrl('/settings/admin/mailsettings'),\n      type: 'POST',\n      data: $('#mail_general_settings_form').serialize(),\n      success: () => {\n        OC.msg.finishedSuccess('#mail_settings_msg', t('settings', 'Saved'));\n      },\n      error: xhr => {\n        OC.msg.finishedError('#mail_settings_msg', xhr.responseJSON);\n      }\n    });\n  };\n  const toggleEmailCredentials = function () {\n    if (OC.PasswordConfirmation.requiresPasswordConfirmation()) {\n      OC.PasswordConfirmation.requirePasswordConfirmation(toggleEmailCredentials);\n      return;\n    }\n    OC.msg.startSaving('#mail_settings_msg');\n    $.ajax({\n      url: OC.generateUrl('/settings/admin/mailsettings/credentials'),\n      type: 'POST',\n      data: $('#mail_credentials_settings').serialize(),\n      success: () => {\n        OC.msg.finishedSuccess('#mail_settings_msg', t('settings', 'Saved'));\n      },\n      error: xhr => {\n        OC.msg.finishedError('#mail_settings_msg', xhr.responseJSON);\n      }\n    });\n  };\n  $('#mail_general_settings_form').change(changeEmailSettings);\n  $('#mail_credentials_settings_submit').click(toggleEmailCredentials);\n  $('#mail_smtppassword').click(() => {\n    if (this.type === 'text' && this.value === '********') {\n      this.type = 'password';\n      this.value = '';\n    }\n  });\n  $('#sendtestemail').click(event => {\n    event.preventDefault();\n    OC.msg.startAction('#sendtestmail_msg', t('settings', 'Sendingâ€¦'));\n    $.ajax({\n      url: OC.generateUrl('/settings/admin/mailtest'),\n      type: 'POST',\n      success: () => {\n        OC.msg.finishedSuccess('#sendtestmail_msg', t('settings', 'Email sent'));\n      },\n      error: xhr => {\n        OC.msg.finishedError('#sendtestmail_msg', xhr.responseJSON);\n      }\n    });\n  });\n  const setupChecks = () => {\n    // run setup checks then gather error messages\n    $.when(OC.SetupChecks.checkSetup()).then(messages => {\n      const $el = $('#postsetupchecks');\n      $('#security-warning-state-loading').addClass('hidden');\n      let hasMessages = false;\n      const $errorsEl = $el.find('.errors');\n      const $warningsEl = $el.find('.warnings');\n      const $infoEl = $el.find('.info');\n      for (let i = 0; i < messages.length; i++) {\n        switch (messages[i].type) {\n          case OC.SetupChecks.MESSAGE_TYPE_INFO:\n            $infoEl.append('<li>' + messages[i].msg + '</li>');\n            break;\n          case OC.SetupChecks.MESSAGE_TYPE_WARNING:\n            $warningsEl.append('<li>' + messages[i].msg + '</li>');\n            break;\n          case OC.SetupChecks.MESSAGE_TYPE_ERROR:\n          default:\n            $errorsEl.append('<li>' + messages[i].msg + '</li>');\n        }\n      }\n      if ($errorsEl.find('li').length > 0) {\n        $errorsEl.removeClass('hidden');\n        hasMessages = true;\n      }\n      if ($warningsEl.find('li').length > 0) {\n        $warningsEl.removeClass('hidden');\n        hasMessages = true;\n      }\n      if ($infoEl.find('li').length > 0) {\n        $infoEl.removeClass('hidden');\n        hasMessages = true;\n      }\n      if (hasMessages) {\n        $('#postsetupchecks-hint').removeClass('hidden');\n        if ($errorsEl.find('li').length > 0) {\n          $('#security-warning-state-failure').removeClass('hidden');\n        } else {\n          $('#security-warning-state-warning').removeClass('hidden');\n        }\n      } else {\n        const securityWarning = $('#security-warning');\n        if (securityWarning.children('ul').children().length === 0) {\n          $('#security-warning-state-ok').removeClass('hidden');\n        } else {\n          $('#security-warning-state-failure').removeClass('hidden');\n        }\n      }\n    });\n  };\n  if (document.getElementById('security-warning') !== null) {\n    setupChecks();\n  }\n});","","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = {};\n__webpack_modules__[\"./apps/settings/src/admin.js\"]();\n",""],"names":[],"sourceRoot":""}